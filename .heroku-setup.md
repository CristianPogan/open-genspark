# Heroku Deployment Guide for GenSpark

## Prerequisites

1. **Heroku CLI installed**: [Install Heroku CLI](https://devcenter.heroku.com/articles/heroku-cli)
2. **Heroku account**: Sign up at [heroku.com](https://www.heroku.com)
3. **Git repository**: Your code should be in a Git repository

## Quick Setup

### 1. Login to Heroku
```bash
heroku login
```

### 2. Add Heroku Remote
```bash
heroku git:remote -a gen-spark
```

### 3. Set Environment Variables

**Option A: Using the provided script (Recommended)**
```bash
chmod +x deploy-heroku.sh
./deploy-heroku.sh
```

**Option B: Manual setup**
```bash
# Set COMPOSIO_API_KEY
heroku config:set COMPOSIO_API_KEY="your-composio-api-key" -a gen-spark

# Set GOOGLE_GENERATIVE_AI_API_KEY
heroku config:set GOOGLE_GENERATIVE_AI_API_KEY="your-google-ai-api-key" -a gen-spark

# NODE_ENV is automatically set, but you can ensure it's production
heroku config:set NODE_ENV=production -a gen-spark
```

### 4. Deploy to Heroku
```bash
# Commit your changes (if not already committed)
git add -A
git commit -m "Prepare for Heroku deployment"

# Push to Heroku
git push heroku main
```

### 5. Open Your App
```bash
heroku open -a gen-spark
```

## Required Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `COMPOSIO_API_KEY` | Your Composio API key for tool integrations | ✅ Yes |
| `GOOGLE_GENERATIVE_AI_API_KEY` | Google Gemini API key for AI responses | ✅ Yes |
| `NODE_ENV` | Environment (automatically set to `production` by Heroku) | Auto |

## Verify Configuration

Check your environment variables:
```bash
heroku config -a gen-spark
```

## View Logs

```bash
# Real-time logs
heroku logs --tail -a gen-spark

# Last 100 lines
heroku logs -n 100 -a gen-spark
```

## Troubleshooting

### Build Fails
- Check logs: `heroku logs --tail -a gen-spark`
- Ensure all environment variables are set
- Verify `package.json` has correct build scripts

### App Crashes
- Check logs for errors
- Verify environment variables are correct
- Ensure Node.js version is compatible (Heroku uses Node 20.x by default)

### Port Issues
- Next.js automatically uses `PORT` environment variable (set by Heroku)
- The `start` script in `package.json` handles this: `next start -p ${PORT:-3000}`

## Files Created for Heroku

1. **Procfile**: Tells Heroku how to run your app
2. **deploy-heroku.sh**: Script to set environment variables
3. **package.json**: Updated with `heroku-postbuild` script
4. **next.config.ts**: Updated with `output: 'standalone'` for Heroku compatibility

## Additional Heroku Commands

```bash
# Restart the app
heroku restart -a gen-spark

# Scale dynos (if needed)
heroku ps:scale web=1 -a gen-spark

# Run one-off commands
heroku run bash -a gen-spark

# Check app status
heroku ps -a gen-spark
```

## Notes

- Heroku automatically detects Next.js apps
- The `heroku-postbuild` script runs `npm run build` after dependencies are installed
- Heroku uses the `web` process type from Procfile to start your app
- Next.js standalone output is optimized for Heroku's deployment model

